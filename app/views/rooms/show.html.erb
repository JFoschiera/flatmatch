<div class="container">
  <div class="mt-3">
    <div id="carouselExampleIndicators" class="carousel slide" data-bs-ride="carousel">
      <div class="carousel-indicators">
        <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
        <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="1" aria-label="Slide 2"></button>
        <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="2" aria-label="Slide 3"></button>
      </div>
      <div class="carousel-inner">
        <% if @room.photos.attached? %>
          <% @room.photos.each_with_index do |photo, index| %>
            <div class="carousel-item <%= index.zero? ? "active" : "" %>">
              <%= cl_image_tag photo.key, class: "d-block w-100", height: 250, width: 400, crop: :fill %>
            </div>
          <% end %>
        <% else %>
          <div class="carousel-item active">
            <%= image_tag 'no-image-found.png', height: 300, width: 400, crop: :fill %>
          </div>
        <% end %>
      </div>
      <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Previous</span>
      </button>
      <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Next</span>
      </button>
    </div>
    <div class="show-body mb-5 bg-white py-2">
      <div class="my-container">
        <div class="container row mt-5">
          <p><strong>Location:</strong> <%= @room.address %></p>
          <p><strong>Price: </strong>R$<%= sprintf("%.2f", @room.price) %></p>
          <p><%= @room.description %></p>
          <div class="d-flex justify-content-between">
            <div>
              <% if (@room.user.answers && @room.user.answers.length > 0) && (current_user.answers && current_user.answers.length > 0) %>
                <% result = 0 %>
                <% @room.user.answers.each_with_index do |answer, index| %>
                  <% current_score = current_user.answers[index].score %>
                  <% answer_score = answer.score %>
                  <% difference = (current_score - answer_score).abs %>
                  <% result += difference %>
                <% end %>
                <span class="badge rounded-pill bg-secondary compatibility-show"><%= 100 - result %>%</span>
              <% end %>
            </div>
            <div>
              <% if @room.likes && @room.likes.where(user: current_user).length > 0 %>
                <%= link_to room_like_path(@room.id, @room.likes.where(user: current_user).first.id), method: :delete, class: 'card-heart-show' do %>
                  <i class="fas fa-heart liked ms-1"></i>
                <% end %>
              <% else %>
                <%= link_to room_likes_path(@room.id), method: :post, class: 'card-heart-show' do %>
                  <i class="fas fa-heart disliked ms-1"></i>
                <% end %>
              <% end %>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div>
      <h4><%= link_to "Back", rooms_path, class: "btn btn-secondary py-2 btn-block", style: "width: 20%" %></h4>
    </div>
  </div>
</div>
